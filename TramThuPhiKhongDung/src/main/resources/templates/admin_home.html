<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <title>Trang chủ</title>
</head>

<body>
    <div class="main">

        <div class="row w-100">
            <div class="left-container col-lg-2 p-0">
                <div class="header-side-bar p-4">
                    <h2>DashBoard</h2>
                </div>
                <ul class="nav flex-column sidebar-nav">
                    <li class="nav-item">
                        <a class="nav-link active p-4 px-5" th:href="@{/admin/trangchu}">
                            Xe qua trạm
                        </a>
                        <hr>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link  p-4 px-5" th:href="@{/admin/quanly/user}">
                            Tài Khoản
                        </a>
                        <hr>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link p-4 px-5" th:href="@{/admin/quanly/quatram}">
                            Lịch Sử
                        </a>
                        <hr>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link p-4 px-5" th:href="@{/dangxuat}">
                            Đăng Xuất
                        </a>
                        <hr>
                    </li>
                </ul>
            </div>
            <div class="right-container col-lg-10">
                <div class="row p-0">
					 <div class="mt-3 text-end">
                        <h5 th:text="${'Xin chào, ' + session.user.ten}"> </h5>
                    </div>
                    <div class="col-lg-11 p-1 text-center">
                        <h2>Xe qua trạm</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="list-item-details p-5">

                        <row class="row p-0 d-flex justify-content-around">
                            <div class="card text-bg-light mb-3  col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Email</div>
                                <div class="card-body">
                                    <h5 id="email" class="card-title"></h5>
                                </div>
                            </div>
    
                            <div class="card text-bg-light mb-3 col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Tên người dùng</div>
                                <div class="card-body">
                                    <h5 id="ten" class="card-title"></h5>
                                </div>
                            </div>
                        </row>

                        <row class="row p-0 d-flex justify-content-around">
                            <div class="card text-bg-light mb-3  col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Ngày sinh</div>
                                <div class="card-body">
                                    <h5 id = "ngaysinh" class="card-title"></h5>
                                </div>
                            </div>
    
                            <div class="card text-bg-light mb-3 col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Biển số</div>
                                <div class="card-body">
                                    <h5 id="bienso" class="card-title"></h5>
                                </div>
                            </div>

                        </row>

                        <row class="row p-0 d-flex justify-content-around">
                            <div class="card text-bg-light mb-3  col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Màu biển</div>
                                <div class="card-body">
                                    <h5 id="maubien" class="card-title"></h5>
                                </div>
                            </div>
    
                            <div class="card text-bg-light mb-3 col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Mã RFID</div>
                                <div class="card-body">
                                    <h5 id="rfid" class="card-title"></h5>
                                </div>
                            </div>
                        </row>
                           <row class="row p-0 d-flex justify-content-around">
                            <div class="card text-bg-light mb-3  col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Quê quán</div>
                                <div class="card-body">
                                    <h5 id="quequan" class="card-title"></h5>
                                </div>
                            </div>
    
                            <div class="card text-bg-light mb-3 col-lg-6" style="max-width: 30rem;">
                                <div class="card-header">Số điện thoại</div>
                                <div class="card-body">
                                    <h5 id="sodienthoai" class="card-title"></h5>
                                </div>
                            </div>
                        </row>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
     <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
	<script>
		const stompClient = new StompJs.Client({
		    brokerURL: 'ws://localhost:8080/ws'
		});		
		connect();
		stompClient.onConnect = (frame) => {
		    console.log('Connected: ' + frame);
		    stompClient.subscribe('/topic/data', (data) => {
		        let user = JSON.parse(data.body);
		        console.log(user);
		        showUser(user);
		    });
		};
		stompClient.onWebSocketError = (error) => {
		    console.error('Error with websocket', error);
		};
		
		stompClient.onStompError = (frame) => {
		    console.error('Broker reported error: ' + frame.headers['message']);
		    console.error('Additional details: ' + frame.body);
		};
		function connect() {
		    stompClient.activate();
		}
		function showUser(user){
			let email = document.getElementById('email');
			let ten = document.getElementById('ten');
			let ngaysinh = document.getElementById('ngaysinh');
			let bienso = document.getElementById('bienso');
			let maubien = document.getElementById('maubien');
			let rfid = document.getElementById('rfid');
			let quequan = document.getElementById('quequan');
			let sodienthoai = document.getElementById('sodienthoai');			
			email.innerText= user.email;
			ten.innerText= user.ten;
			ngaysinh.innerText = user.ngaysinh;
			bienso.innerText = user.bienso;
			maubien.innerText = user.maubien;
			rfid.innerText = user.rfid;
			quequan.innerText = user.quequan;
			sodienthoai.innerText = user.sodienthoai;
			
		}
	</script>
</body>

</html>